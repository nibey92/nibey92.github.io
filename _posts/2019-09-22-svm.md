---
layout: post
title: Regression
excerpt: "SVM, Support Vector Machine"
categories: [machine learning]
comments: true
---


##

오늘은 딥러닝이 생기기 이전 기계학습 분야에서 가장 널리, 유명하게 쓰였던 `Support Vector Machine`에 대해서 알아보도록 하겠습니다. SVM을 제대로 이해하기 위해서는 이와 관련된 수학적인 기법들 (Lagrangian, Daul problrem, KKT) 을 우선적으로 이해하여야 합니다. 하지만 이것들을 모르더라도 전체적인 SVM에 대한 개략적인 방법을 설명하도록 하겠습니다. 

## Idea

SVM이 가장 큰 성능을 내는 것은 분류문제 입니다. 우리는 항상 어떻게 분류할 것인가 하는것은 기계학습에 가장 기본적인 문제이기도 하죠. 여기 두 집단의 데이터가 있습니다. +와 - 집단입니다. 두 집단을 잘 구분하는 선은 둘 중 어느 선일까요?
![graph]({{ site.url }}/img/svm-1.PNG)

대다수의 분들이 1번이라고 할 것입니다. 그 이유는 1번선이 2번선에 비해서 두 집단을 좀 더 여유롭게 분류하고 있기 때문이죠. 이 때 이 '여유로운 ' 공간을  `Margin` 이라고 합니다. 그리고 SVM은 margin을 최대화 하는 분류 경계면을 찾는 기법이라고 할 수 있습니다. 

![graph]({{ site.url }}/img/svm-2.PNG)

## Decision rule

개념적으로 SVM이 어떻게 작동하는지 알아보았습니다. 하지만 늘 그렇듯, 언어로 이해하기는 쉽지만 수학적으로 풀어내기는 쉽지 않죠. margine을 최대화하는 분류 경계면을 찾기 위해 우리는 수학적인 식들을 찾아야 합니다. 먼저 우리가 찾는 분류 경계선이 있을 때 이 경계선이 +와 -를 어떻게 구분하는지 desision rule을 정해봅시다. 

먼저 분류 경계면에 대해 수직인 벡터 $$\vec{w}$$ 를 정의 합니다. 그리고 각 데이터에 대한 벡터 $$\vec{x}$$에 대해 $$\vec{w}$$를 내적하고 이 값이 어떤 상수보다 크면 +, 작으면 -로 분류할 수 있습니다. 여기서 내적을 함으로써 $$\vec{w}$$ 방향으로 $$\vec{x}$$ 를 projection 한다는 의미가 있습니다. 이를 수식으로 쓰면 다음과 같이 쓸 수 있겠죠

![graph]({{ site.url }}/img/svm-3.PNG)


* $$\vec{w} \dot \vec{x} > b \quad then + $$
* $$\vec{w} \dot \vec{x} < b \quad then - $$

사실 이것은 아직 SVM의 식은 아닙니다. SVM의 특징인 `margin`를 첨가해야 겠죠. 또한 이렇게 만들어지는 식의 미지수인 $$\vec{w}$$와 b도 정하지 못했습니다. 우리가 아는 것은 $$\vec{w}$$가 분류경계면과 수직이라는 사실 뿐입니다. 기본적인 식에 조건이나 제약을 추가하여 $$\vec{w}$$와 b를 찾아가는 것이 이번 시간해 해야할 목표가 되겟습닏. 

## Boundary 정의

이제부터 SVM에 필요한 식을 만들어 봅시다. 먼저 decision rule을 참고하여 $$\vec{w}$$와 $$\vec{x}$$를 내적하고 상수 b를 더한 값이 0일때를 분류경계면으로 설정합시다. 

* $$\vec{w} \dot \vec{x} + b = 0  \quad then \quad boundary$$

그럼 0보다 클 때면 + 로 분류해야 할까요? 하지만 SVM에서는 margin 영역이 있습니다. +와 - 어느 데이터도 들어 있지 않은 구간이죠. 이 구간을 정해줍시다.

* $$\vec{w} \dot \vec{x} + b = +1  \quad then \quad Plus \quad boundary$$
* $$\vec{w} \dot \vec{x} + b = -1  \quad then \quad Minus \quad boundary$$

위 식에서 경계선을 각각 1과 -1로 둔 것은 경계면 길이를 1로 normalization 했다고 볼 수 있습니다. 이 세개의 경계면에 대한 식을 그림으로 나타내면 아래와 같습니다. 그림을 보시면 한결 이해하기 편할 겁니다. 

![graph]({{ site.url }}/img/svm-4.PNG)

## 제약식의 정의

앞에서 boundary에 대한 식을 보았습니다. 이제 실제 데이터가 있는 공간 Plust plane과 Minus plane에 속해있는 데이터 벡터들 $$\vec{x_+}$$와 $$\vec{x_-}$$를 가지고 제약식을 정의해 보도록 하겠습니다. 두 벡터
